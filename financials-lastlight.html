<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kato.8 Studios — Last Light Financial Breakdown</title>
  <style>
    :root{
      --bg:#07070b;
      --panel:#0f0f18;
      --panel2:#0c0c14;
      --text:#f3f3ff;
      --muted:#b9b9d6;
      --line:rgba(255,255,255,.12);
      --accent:#ff4fd8;
      --accent2:#6be4ff;
      --good:#8dffb3;
      --warn:#ffd36b;
      --bad:#ff7a7a;
      --shadow: 0 18px 40px rgba(0,0,0,.45);
      --radius:18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(900px 500px at 20% -10%, rgba(255,79,216,.20), transparent 65%),
                  radial-gradient(900px 500px at 85% 0%, rgba(107,228,255,.16), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.35;
    }

    .wrap{ max-width:1100px; margin:0 auto; padding:44px 18px 70px; }

    /* keep your existing “site” header feel simple */
    .sitehdr{
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      margin-bottom:18px;
      padding:12px 14px;
      border:1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      background: rgba(0,0,0,.18);
    }
    .brand{
      display:flex; flex-direction:column; gap:2px;
    }
    .brand .name{
      font-weight:900; letter-spacing:.2px;
      display:flex; align-items:center; gap:10px;
    }
    .spark{
      width:10px; height:10px; border-radius:999px;
      background: var(--accent);
      box-shadow:0 0 18px rgba(255,79,216,.45);
      display:inline-block;
    }
    .brand .tag{ font-size:12px; color:var(--muted); }
    .nav{
      display:flex; flex-wrap:wrap; gap:10px; justify-content:flex-end;
      align-items:center;
    }
    .nav a{
      color:var(--muted);
      font-size:13px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid transparent;
      text-decoration:none;
    }
    .nav a:hover{
      color:var(--text);
      border-color: rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
    }

    .top{
      display:flex; flex-wrap:wrap; gap:14px;
      align-items:flex-end; justify-content:space-between;
      margin-bottom:18px;
    }

    h1{
      margin:0;
      font-size: clamp(26px, 3vw, 40px);
      letter-spacing:.2px;
    }
    .sub{
      margin:6px 0 0;
      color:var(--muted);
      max-width:850px;
      font-size: 15px;
    }

    .badge-row{
      display:flex; flex-wrap:wrap; gap:10px; margin-top:14px;
    }
    .badge{
      border:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      display:inline-flex; align-items:center; gap:8px;
      white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:999px; background:var(--accent); box-shadow:0 0 14px rgba(255,79,216,.45); }
    .dot2{ background:var(--accent2); box-shadow:0 0 14px rgba(107,228,255,.35); }

    .grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:14px;
      margin-top:18px;
    }
    @media (max-width: 920px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,79,216,.10), rgba(255,255,255,0));
    }
    .card .bd{ padding:16px; }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .pillset{
      display:flex;
      border:1px solid var(--line);
      background: rgba(0,0,0,.25);
      border-radius:999px;
      overflow:hidden;
    }
    .pill{
      padding:10px 12px;
      font-size:13px;
      cursor:pointer;
      color:var(--muted);
      background:transparent;
      border:0;
    }
    .pill[aria-selected="true"]{
      color:var(--text);
      background: linear-gradient(180deg, rgba(255,79,216,.20), rgba(255,255,255,.02));
    }

    select{
      appearance:none;
      border-radius:12px;
      border:1px solid var(--line);
      background: rgba(0,0,0,.25);
      color:var(--text);
      padding:10px 12px;
      font-size:13px;
      outline:none;
    }

    .kpis{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:14px;
    }
    @media (max-width: 560px){
      .kpis{ grid-template-columns: 1fr; }
    }
    .kpi{
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px;
      background: rgba(0,0,0,.22);
    }
    .kpi .lbl{ font-size:12px; color:var(--muted); }
    .kpi .val{ margin-top:6px; font-size:18px; font-weight:700; letter-spacing:.2px; }
    .kpi .hint{ margin-top:6px; font-size:12px; color:var(--muted); }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:12px;
      font-size:13px;
    }
    th, td{
      text-align:left;
      padding:10px 8px;
      border-bottom:1px solid var(--line);
      vertical-align:top;
    }
    th{ color:var(--muted); font-weight:600; font-size:12px; letter-spacing:.2px; }
    tr:last-child td{ border-bottom:0; }

    .money{
      font-variant-numeric: tabular-nums;
      white-space:nowrap;
      font-weight:650;
      font-family: var(--mono);
    }
    .note{
      margin-top:12px;
      color:var(--muted);
      font-size:12px;
    }
    .callout{
      border:1px dashed rgba(255,79,216,.45);
      background: rgba(255,79,216,.07);
      padding:12px;
      border-radius:16px;
      color:var(--muted);
      font-size:12px;
      margin-top:12px;
    }
    .callout strong{ color:var(--text); }

    .list{
      margin:0; padding-left:18px; color:var(--muted);
      font-size:13px;
    }
    .list li{ margin:8px 0; }

    .footer{
      margin-top:18px;
      color:var(--muted);
      font-size:12px;
      border-top:1px solid var(--line);
      padding-top:14px;
    }

    .fieldgrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 980px){ .fieldgrid{ grid-template-columns: 1fr 1fr; } }
    @media (max-width: 520px){ .fieldgrid{ grid-template-columns: 1fr; } }
    .field{
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px;
      background: rgba(0,0,0,.22);
    }
    .field label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }
    .field input, .field select{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      color:var(--text);
      padding:10px 12px;
      font-size:13px;
      outline:none;
      font-family: var(--mono);
    }
    .btn{
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(255,79,216,.22), rgba(255,255,255,.03));
      color:var(--text);
      padding:10px 12px;
      font-weight:800;
      letter-spacing:.2px;
      cursor:pointer;
      font-size:13px;
    }
    .btn:hover{ border-color: rgba(255,255,255,.28); }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- light header so page still matches your site without major change -->
    <div class="sitehdr">
      <div class="brand">
        <div class="name"><span class="spark"></span> <a href="index.html" style="color:var(--text); text-decoration:none;">Kato.8 Studios LLC</a></div>
        <div class="tag">Retro × Modern — in gameplay and aesthetics</div>
      </div>
      <div class="nav">
        <a href="games.html">Games</a>
        <a href="updates.html">Updates</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>

    <div class="top">
      <div>
        <h1>Last Light — Financial Breakdown</h1>
        <p class="sub">
          A transparent view of (1) the <b>Demo</b> cost to produce a 10–15 minute vertical slice, and (2) scalable
          <b>Full Game</b> budgets to take Last Light to commercial release.
        </p>
        <div class="badge-row">
          <div class="badge"><span class="dot"></span> Demo tiers sourced from internal funding strategy doc</div>
          <div class="badge"><span class="dot dot2"></span> Full-game numbers are adjustable estimates</div>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT: INTERACTIVE BREAKDOWN -->
      <div class="card">
        <div class="hd">
          <div class="controls">
            <div class="pillset" role="tablist" aria-label="Budget type">
              <button class="pill" id="tab-demo" role="tab" aria-selected="true">Demo</button>
              <button class="pill" id="tab-full" role="tab" aria-selected="false">Full Game</button>
            </div>

            <select id="scenario"></select>
          </div>

          <div class="kpis">
            <div class="kpi">
              <div class="lbl">Budget Range</div>
              <div class="val" id="kpiBudget">$—</div>
              <div class="hint">Total estimate (range)</div>
            </div>
            <div class="kpi">
              <div class="lbl">Timeline</div>
              <div class="val" id="kpiTimeline">—</div>
              <div class="hint">Calendar months</div>
            </div>
            <div class="kpi">
              <div class="lbl">Team Model</div>
              <div class="val" id="kpiTeam">—</div>
              <div class="hint">Core roles / staffing</div>
            </div>
          </div>
        </div>

        <div class="bd">
          <div id="summary"></div>

          <table aria-label="Line item budget table">
            <thead>
              <tr>
                <th style="width:46%">Cost Category</th>
                <th style="width:22%">Low</th>
                <th style="width:22%">High</th>
                <th style="width:10%">Notes</th>
              </tr>
            </thead>
            <tbody id="lines"></tbody>
          </table>

          <div class="callout" id="callout"></div>
          <div class="note" id="note"></div>
        </div>
      </div>

      <!-- RIGHT: INVESTOR-FACING NOTES -->
      <div class="card">
        <div class="hd">
          <div style="font-weight:700">What investors get at each stage</div>
          <div style="color:var(--muted); font-size:12px; margin-top:6px">
            This copy is designed to live on the investor site alongside the budget selectors.
          </div>
        </div>

        <div class="bd">
          <ul class="list">
            <li>
              <b>Demo funding</b> buys a playable proof-of-concept: combat feel, resource loop, base defense, onboarding, and a presentable build for pitch, festivals, and community tests.
            </li>
            <li>
              <b>Full game funding</b> expands content breadth + production readiness: multiple biomes, deeper progression, more enemies/turrets, narrative presentation, performance + platform QA, marketing beats, and launch operations.
            </li>
            <li>
              Budgets are shown as <b>ranges</b> to reflect the real-world variance of contractor rates, scope decisions, and polish depth.
            </li>
          </ul>

          <div class="callout">
            <strong>Investor clarity:</strong> Demo tiers below are pulled from the studio’s “Last Light — Funding Strategy Document”
            and presented as-is (Tier 1 / 2 / 3). Full-game budgets are stated as estimates and can be replaced with your
            exact milestone plan later.
          </div>

          <div class="footer">
            If you want, I can also generate a second page called <b>“Use of Funds & Milestones”</b> that maps each line item
            to milestones (Prototype → Vertical Slice → Beta → Launch) so the spend feels directly tied to deliverables.
          </div>
        </div>
      </div>
    </div>

    <!-- NEW: FORECASTING (added below existing layout; no layout changes above) -->
    <div class="card" style="margin-top:14px;">
      <div class="hd">
        <div style="font-weight:900; letter-spacing:.2px">Forecasting (Revenue + Break-even)</div>
        <div style="color:var(--muted); font-size:12px; margin-top:6px">
          A lightweight forecast to estimate units needed to recoup the selected budget range and how quickly revenue can return capital.
        </div>
      </div>
      <div class="bd">
        <div class="fieldgrid">
          <div class="field">
            <label>Game Price ($)</label>
            <input id="f_price" type="number" min="0" step="0.5" value="19.99" />
          </div>
          <div class="field">
            <label>Platform Fee (%)</label>
            <input id="f_platform" type="number" min="0" max="100" step="0.5" value="30" />
          </div>
          <div class="field">
            <label>Marketing % of Gross</label>
            <input id="f_mktpct" type="number" min="0" max="100" step="0.5" value="10" />
          </div>
          <div class="field">
            <label>Fixed Launch Marketing ($)</label>
            <input id="f_mktfixed" type="number" min="0" step="500" value="25000" />
          </div>

          <div class="field">
            <label>Month 1 Units (Base)</label>
            <input id="f_m1" type="number" min="0" step="100" value="12000" />
          </div>
          <div class="field">
            <label>Monthly Decay (%)</label>
            <input id="f_decay" type="number" min="0" max="50" step="0.5" value="8" />
          </div>
          <div class="field">
            <label>Scenario Spread (%)</label>
            <input id="f_spread" type="number" min="0" max="60" step="1" value="25" />
          </div>
          <div class="field" style="display:flex; align-items:end;">
            <button class="btn" id="f_csv" type="button" style="width:100%;">Download Forecast CSV</button>
          </div>
        </div>

        <div class="callout" id="f_summary" style="margin-top:12px;">
          <strong>Summary:</strong> —
        </div>

        <table aria-label="Forecast table">
          <thead>
            <tr>
              <th>Month</th>
              <th>Scenario</th>
              <th>Units</th>
              <th>Gross</th>
              <th>Marketing</th>
              <th>Net (after platform + marketing)</th>
              <th>Cumulative Net</th>
              <th>Break-even vs Selected Budget</th>
            </tr>
          </thead>
          <tbody id="f_rows"></tbody>
        </table>

        <div class="note">
          Notes: This is a simplified model (price × units) with platform fee + marketing deductions only.
          It’s meant to communicate investor-ready directional outcomes, not replace full P&L.
        </div>
      </div>
    </div>

  </div>

  <script>
    // ----------------------------
    // Existing helper
    // ----------------------------
    const money = (n) => {
      if (n === null || n === undefined || !isFinite(n)) return "—";
      return "$" + n.toLocaleString("en-US", { maximumFractionDigits: 0 });
    };

    // ----------------------------
    // DATA (Marketing added as explicit line item; everything else unchanged)
    // ----------------------------
    const demoScenarios = [
      {
        id: "demo_t1",
        name: "Tier 1 — Lean & Fast Demo",
        budgetLow: 120000,
        budgetHigh: 160000,
        timeline: "6–7 months",
        team: "3–4 core + contractors",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            Minimal-but-polished indie demo designed to unlock larger external funding.
          </p>
          <ul class="list">
            <li>One biome, one enemy type (simple variants), one turret, one weapon set.</li>
            <li>Functional UI, simplified VFX, minimal onboarding prompts.</li>
          </ul>
        `,
        lines: [
          { cat: "Core Dev + Design Labor", low: 65000, high: 90000, note: "Primary burn" },
          { cat: "Art + UI/UX", low: 25000, high: 38000, note: "0.5–0.75 FTE" },
          { cat: "Audio (contract)", low: 4000, high: 9000, note: "1–1.5 mo" },
          { cat: "QA (contract)", low: 3000, high: 7000, note: "Final month" },
          { cat: "Tools / Software / Services", low: 1500, high: 4000, note: "Unity/PM/etc." },

          /* NEW: explicit marketing line for demo (store page, key art, trailer-lite) */
          { cat: "Marketing / Store Assets", low: 1500, high: 6000, note: "Capsule + trailer-lite" },

          { cat: "Build/Release Ops (packaging)", low: 1000, high: 3000, note: "Light ops" },
          { cat: "Contingency", low: 7500, high: 15000, note: "Risk buffer" },
        ],
        callout: "Best for: proving execution, pitching to publishers, securing grants with a lean burn.",
        note: "Demo tier ranges and timelines are sourced from the studio funding strategy document. Adjust line-item allocations to match your exact contractor rates."
      },
      {
        id: "demo_t2",
        name: "Tier 2 — Polished Vertical Slice (Recommended)",
        budgetLow: 220000,
        budgetHigh: 300000,
        timeline: "7–8 months",
        team: "4–6 core + optional tech art",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            Balanced team for higher fidelity, polish, and market readiness (publisher-ready vertical slice).
          </p>
          <ul class="list">
            <li>More polished art/animation, improved VFX, stronger UI/UX, audio layers, environment polish.</li>
            <li>Optional interior or narrative intro; stronger trailer/marketing assets.</li>
          </ul>
        `,
        lines: [
          { cat: "Core Dev + Systems + Design", low: 105000, high: 145000, note: "Primary burn" },
          { cat: "Art + UI/UX (full-time)", low: 60000, high: 80000, note: "Fidelity jump" },
          { cat: "Audio (2–3 mo contract)", low: 9000, high: 18000, note: "Music+SFX" },
          { cat: "QA (2–3 mo)", low: 9000, high: 18000, note: "Test cycles" },
          { cat: "Tech Art (optional)", low: 6000, high: 14000, note: "Shaders/VFX" },
          { cat: "Tools / Software / Services", low: 2500, high: 6000, note: "PM/Build" },

          /* NEW: explicit marketing line for demo */
          { cat: "Marketing / Trailer / Key Art", low: 8000, high: 22000, note: "Pitch-ready" },

          { cat: "Contingency", low: 14000, high: 22000, note: "Risk buffer" },
        ],
        callout: "Best for: Steam Next Fest readiness, major publisher outreach, strong community tests.",
        note: "Demo tier ranges and timelines are sourced from the studio funding strategy document. Line items are presented as editable allocations for investor clarity."
      },
      {
        id: "demo_t3",
        name: "Tier 3 — Showpiece Demo + Early Production Start",
        budgetLow: 350000,
        budgetHigh: 500000,
        timeline: "8–10 months",
        team: "8–10+ (full-stack model)",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            Premier-quality vertical slice that doubles as the foundation for full production.
          </p>
          <ul class="list">
            <li>2–3 zombie types, multiple turrets, advanced VFX, cinematic intro/cutscene panels.</li>
            <li>Higher production depth across disciplines; heavier QA runway.</li>
          </ul>
        `,
        lines: [
          { cat: "Engineering (2 devs) + Design", low: 170000, high: 235000, note: "Multi-dev" },
          { cat: "Environment + Character Animation", low: 90000, high: 135000, note: "Premium art" },
          { cat: "UI/UX Specialist", low: 25000, high: 42000, note: "Rich UI" },
          { cat: "Tech Art / VFX", low: 20000, high: 35000, note: "Shaders/FX" },
          { cat: "Audio (0.5–1.0 FTE / contract)", low: 18000, high: 35000, note: "Layered audio" },
          { cat: "QA Lead + Tester (final 4 mo)", low: 22000, high: 48000, note: "Heavier QA" },
          { cat: "Tools / Software / Services", low: 4000, high: 9000, note: "Production ops" },

          /* NEW: explicit marketing line for demo */
          { cat: "Marketing / Showcase Assets", low: 15000, high: 40000, note: "Trailer + press kit" },

          { cat: "Contingency", low: 18000, high: 36000, note: "Risk buffer" },
        ],
        callout: "Best for: high-end pitch meetings, showcases, and building momentum for full production funding.",
        note: "Demo tier ranges and timelines are sourced from the studio funding strategy document. Line items are illustrative allocations (edit to match real rates)."
      },
    ];

    const fullGameScenarios = [
      {
        id: "full_indie",
        name: "Full Game — Indie Lean Release",
        budgetLow: 650000,
        budgetHigh: 950000,
        timeline: "14–18 months",
        team: "5–7 core + contractors",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            A focused commercial release with strong core loop, limited content breadth, and controlled burn.
          </p>
          <ul class="list">
            <li>2–3 biomes, modest narrative wrapper, progression + crafting depth, optimized for PC launch first.</li>
            <li>Marketing is lean but deliberate (store page, trailer, community beats, festival presence).</li>
          </ul>
        `,
        lines: [
          { cat: "Engineering + Design", low: 260000, high: 380000, note: "Systems/content" },
          { cat: "Art + Animation", low: 190000, high: 280000, note: "2D pipeline" },
          { cat: "UI/UX + Accessibility", low: 45000, high: 80000, note: "Polish" },
          { cat: "Audio (SFX + OST)", low: 35000, high: 70000, note: "Contract/partial" },
          { cat: "QA + Compatibility", low: 45000, high: 90000, note: "Launch readiness" },
          { cat: "Production/PM + Ops", low: 28000, high: 65000, note: "Scheduling/vendors" },

          /* NEW: explicit marketing line for full game */
          { cat: "Marketing / Trailer / PR", low: 40000, high: 120000, note: "Launch beats" },

          { cat: "Tools/Software/Services", low: 8000, high: 22000, note: "Dev services" },
          { cat: "Contingency", low: 19000, high: 38000, note: "Buffer" },
        ],
        callout: "Positioning: capital-efficient release that proves the franchise and improves publisher leverage for ports/sequels.",
        note: "Full-game scenario numbers are estimates for investor communication. Replace with your exact milestone plan + vendor quotes as you lock scope."
      },
      {
        id: "full_mid",
        name: "Full Game — Mid-Scope Flagship Indie",
        budgetLow: 1200000,
        budgetHigh: 1800000,
        timeline: "18–24 months",
        team: "8–12 core + partners",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            The “flagship indie” path: deeper content variety, higher polish, and better long-tail retention.
          </p>
          <ul class="list">
            <li>3–5 biomes, more enemy/turret variety, richer progression, more narrative presentation.</li>
            <li>PC launch + planning runway for ports; stronger marketing calendar.</li>
          </ul>
        `,
        lines: [
          { cat: "Engineering + Design", low: 500000, high: 720000, note: "More depth" },
          { cat: "Art + Animation + VFX", low: 360000, high: 560000, note: "Content breadth" },
          { cat: "UI/UX + Localization + Accessibility", low: 90000, high: 160000, note: "Market readiness" },
          { cat: "Audio (OST + implementation)", low: 70000, high: 140000, note: "Higher quality" },
          { cat: "QA + Performance", low: 90000, high: 180000, note: "Stability" },
          { cat: "Production/PM + Outsourcing mgmt", low: 70000, high: 140000, note: "Vendor control" },

          /* NEW: explicit marketing line for full game */
          { cat: "Marketing / Trailer / PR", low: 120000, high: 260000, note: "Go-to-market" },

          { cat: "Tools/Software/Services", low: 15000, high: 40000, note: "Build/CI/etc." },
          { cat: "Contingency", low: 40000, high: 80000, note: "Buffer" },
        ],
        callout: "Positioning: stronger commercial indie with higher chance of feature coverage and streamer traction.",
        note: "Full-game scenario numbers are estimates for investor communication. Swap these with your real staffing plan once scope is locked."
      },
      {
        id: "full_premium",
        name: "Full Game — Premium AA-Indie + Ports",
        budgetLow: 2500000,
        budgetHigh: 4000000,
        timeline: "24–30 months",
        team: "12–18 core + outsourcing",
        summary: `
          <p style="margin:0 0 8px; color:var(--muted); font-size:13px">
            Premium production values, more content variety, and the operational runway to support multi-platform launches.
          </p>
          <ul class="list">
            <li>More biomes and mission variety, richer narrative, expanded systems, deeper endgame.</li>
            <li>Heavier QA, localization, compliance, and porting pipeline (timing dependent).</li>
          </ul>
        `,
        lines: [
          { cat: "Engineering + Design", low: 980000, high: 1500000, note: "Bigger team" },
          { cat: "Art + Animation + VFX", low: 820000, high: 1350000, note: "Premium content" },
          { cat: "UI/UX + Localization", low: 180000, high: 320000, note: "Global" },
          { cat: "Audio (OST + VO/light narrative)", low: 140000, high: 260000, note: "Premium" },
          { cat: "QA + External testing", low: 220000, high: 420000, note: "Heavier QA" },
          { cat: "Production/PM + Outsourcing + Legal", low: 150000, high: 280000, note: "Ops" },

          /* NEW: explicit marketing line for full game */
          { cat: "Marketing / PR / Influencers", low: 260000, high: 650000, note: "Launch weight" },

          { cat: "Porting/Platform Services (if applicable)", low: 180000, high: 420000, note: "Varies" },
          { cat: "Tools/Software/Services", low: 30000, high: 80000, note: "Infra" },
          { cat: "Contingency", low: 60000, high: 120000, note: "Buffer" },
        ],
        callout: "Positioning: premium flagship title with stronger platform/publisher appeal and multi-platform revenue potential.",
        note: "Full-game scenario numbers are estimates for investor communication. Porting/cert costs vary heavily by platform and partner rates."
      },
    ];

    // ----------------------------
    // UI STATE (existing)
    // ----------------------------
    const tabDemo = document.getElementById("tab-demo");
    const tabFull = document.getElementById("tab-full");
    const scenarioSelect = document.getElementById("scenario");

    const kpiBudget = document.getElementById("kpiBudget");
    const kpiTimeline = document.getElementById("kpiTimeline");
    const kpiTeam = document.getElementById("kpiTeam");

    const summary = document.getElementById("summary");
    const lines = document.getElementById("lines");
    const callout = document.getElementById("callout");
    const note = document.getElementById("note");

    // Forecast UI
    const f_price = document.getElementById("f_price");
    const f_platform = document.getElementById("f_platform");
    const f_mktpct = document.getElementById("f_mktpct");
    const f_mktfixed = document.getElementById("f_mktfixed");
    const f_m1 = document.getElementById("f_m1");
    const f_decay = document.getElementById("f_decay");
    const f_spread = document.getElementById("f_spread");
    const f_rows = document.getElementById("f_rows");
    const f_summary = document.getElementById("f_summary");
    const f_csv = document.getElementById("f_csv");

    let mode = "demo"; // demo | full
    let currentScenario = null;

    function setMode(nextMode){
      mode = nextMode;
      tabDemo.setAttribute("aria-selected", mode === "demo");
      tabFull.setAttribute("aria-selected", mode === "full");

      scenarioSelect.innerHTML = "";
      const data = mode === "demo" ? demoScenarios : fullGameScenarios;

      data.forEach(s => {
        const opt = document.createElement("option");
        opt.value = s.id;
        opt.textContent = s.name;
        scenarioSelect.appendChild(opt);
      });

      scenarioSelect.selectedIndex = data.length >= 2 ? 1 : 0;
      render();
    }

    function render(){
      const data = mode === "demo" ? demoScenarios : fullGameScenarios;
      const s = data.find(x => x.id === scenarioSelect.value) || data[0];
      currentScenario = s;

      kpiBudget.textContent = `${money(s.budgetLow)} – ${money(s.budgetHigh)}`;
      kpiTimeline.textContent = s.timeline;
      kpiTeam.textContent = s.team;

      summary.innerHTML = s.summary;

      lines.innerHTML = "";
      s.lines.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.cat}</td>
          <td class="money">${money(row.low)}</td>
          <td class="money">${money(row.high)}</td>
          <td style="color:var(--muted); font-size:12px">${row.note || ""}</td>
        `;
        lines.appendChild(tr);
      });

      callout.textContent = s.callout;
      note.textContent = s.note;

      renderForecast(); // keep in sync with selection
    }

    tabDemo.addEventListener("click", () => setMode("demo"));
    tabFull.addEventListener("click", () => setMode("full"));
    scenarioSelect.addEventListener("change", render);

    // ----------------------------
    // Forecasting (NEW)
    // ----------------------------
    function mny(n){
      if(!isFinite(n)) return "—";
      return "$" + Math.round(n).toLocaleString("en-US");
    }
    function clamp(n,a,b){ return Math.min(b, Math.max(a,n)); }
    function pct(v){ return clamp(Number(v)||0, 0, 100)/100; }

    function buildForecastRows(mult){
      // 12 months: month1 units base then decay
      const price = Math.max(0, Number(f_price.value) || 0);
      const platform = pct(f_platform.value);
      const mktpct = pct(f_mktpct.value);
      const fixedMkt = Math.max(0, Number(f_mktfixed.value) || 0);

      const m1Units = Math.max(0, Number(f_m1.value) || 0) * mult;
      const decay = pct(f_decay.value); // as percent

      const rows = [];
      let units = m1Units;
      let cumNet = 0;

      for(let i=0;i<12;i++){
        const monthLabel = `M${i+1}`;
        const gross = units * price;
        const marketing = (gross * mktpct) + (i===0 ? fixedMkt : 0);
        const net = Math.max(0, (gross * (1 - platform)) - marketing);
        cumNet += net;

        rows.push({ month: monthLabel, units, gross, marketing, net, cumNet });

        units = units * (1 - decay); // decay after each month
      }
      return rows;
    }

    function firstBreakEvenMonth(rows, target){
      for(let i=0;i<rows.length;i++){
        if(rows[i].cumNet >= target) return i+1;
      }
      return null;
    }

    function renderForecast(){
      if(!currentScenario) return;

      const s = currentScenario;
      const spread = pct(f_spread.value);
      const lowMult = 1 - spread;
      const baseMult = 1;
      const highMult = 1 + spread;

      const lowRows = buildForecastRows(lowMult);
      const baseRows = buildForecastRows(baseMult);
      const highRows = buildForecastRows(highMult);

      const total = (rows, key) => rows.reduce((a,r)=>a+(r[key]||0),0);

      const baseGross = total(baseRows, "gross");
      const baseMkt = total(baseRows, "marketing");
      const baseNet = total(baseRows, "net");

      // Break-even uses selected scenario budget range
      const beLow = firstBreakEvenMonth(baseRows, s.budgetLow);
      const beHigh = firstBreakEvenMonth(baseRows, s.budgetHigh);

      // Units needed (range) based on per-unit net in Month 1 (rough investor-friendly shortcut)
      const price = Math.max(0, Number(f_price.value) || 0);
      const platform = pct(f_platform.value);
      const mktpct = pct(f_mktpct.value);
      const perUnitNetApprox = Math.max(0.01, (price * (1 - platform)) * (1 - mktpct)); // ignores fixed marketing
      const unitsLow = Math.ceil(s.budgetLow / perUnitNetApprox);
      const unitsHigh = Math.ceil(s.budgetHigh / perUnitNetApprox);

      f_summary.innerHTML = `<strong>Summary (Base scenario, 12 months):</strong>
        Gross <b>${mny(baseGross)}</b> • Marketing <b>${mny(baseMkt)}</b> • Net <b>${mny(baseNet)}</b><br/>
        <strong>Break-even (vs selected budget):</strong> ${beLow ? `~Month ${beLow} (low)` : "Not reached (low)"} / ${beHigh ? `~Month ${beHigh} (high)` : "Not reached (high)"}<br/>
        <strong>Units to recoup (approx):</strong> ${unitsLow.toLocaleString("en-US")} – ${unitsHigh.toLocaleString("en-US")} units
        <span style="color:var(--muted);"> (uses per-unit net estimate; fixed marketing handled in monthly table)</span>`;

      // Table rows: Low/Base/High blocks
      f_rows.innerHTML = "";
      function addBlock(label, rows){
        rows.forEach(r=>{
          const target = s.budgetLow; // for month-by-month indicator, show low target (cleaner)
          const status = r.cumNet >= target ? "Yes" : "No";
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${r.month}</td>
            <td><b>${label}</b></td>
            <td class="money">${Math.round(r.units).toLocaleString("en-US")}</td>
            <td class="money">${mny(r.gross)}</td>
            <td class="money">${mny(r.marketing)}</td>
            <td class="money">${mny(r.net)}</td>
            <td class="money">${mny(r.cumNet)}</td>
            <td style="color:var(--muted); font-size:12px">${status}</td>
          `;
          f_rows.appendChild(tr);
        });
      }
      addBlock("Low", lowRows);
      addBlock("Base", baseRows);
      addBlock("High", highRows);
    }

    function exportForecastCSV(){
      if(!currentScenario) return;
      const s = currentScenario;

      const spread = pct(f_spread.value);
      const scenarios = [
        { name:"Low", mult:1-spread },
        { name:"Base", mult:1 },
        { name:"High", mult:1+spread }
      ];

      const rows = [];
      rows.push(["Month","Scenario","Units","Gross","Marketing","Net","CumulativeNet","BudgetLow","BudgetHigh"]);

      scenarios.forEach(sc=>{
        const data = buildForecastRows(sc.mult);
        data.forEach(r=>{
          rows.push([
            r.month,
            sc.name,
            Math.round(r.units),
            Math.round(r.gross),
            Math.round(r.marketing),
            Math.round(r.net),
            Math.round(r.cumNet),
            s.budgetLow,
            s.budgetHigh
          ]);
        });
      });

      const csv = rows.map(r=>r.join(",")).join("\n");
      const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "last_light_forecast_12mo.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Forecast input listeners
    [f_price,f_platform,f_mktpct,f_mktfixed,f_m1,f_decay,f_spread].forEach(el=>{
      el.addEventListener("input", renderForecast);
      el.addEventListener("change", renderForecast);
    });
    f_csv.addEventListener("click", exportForecastCSV);

    // Init
    setMode("demo");
  </script>
</body>
</html>
